<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Le hack 2023</title>
<link rel="stylesheet" href="/assets/css/styles.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="/assets/css/monokai.css">
  </head>
  <body data-bs-theme="dark">
    <header class="d-flex py-3 mb-4 border-bottom" style="align-items: center; justify-content: space-around;">
    <a href="/" class="d-flex align-items-center text-dark text-decoration-none">
      <span class="fs-4"><span class="logo1">Hack</span><span class="logo2">vens</span></span>
    </a>
    <button id="btnSwitch" class="">ğŸ’¡/ğŸŒ™</button>
    <script defer="defer">
      document.getElementById('btnSwitch').addEventListener('click',()=>{
      if (document.body.getAttribute('data-bs-theme') == 'dark') {
          document.body.setAttribute('data-bs-theme','light')
          document.documentElement.style.setProperty("--logo-color1", "#161616")
      }
      else {
          document.body.setAttribute('data-bs-theme','dark')
          document.documentElement.style.setProperty("--logo-color1", "#fff")

      }
      })
    </script>
  </header>
    <div class="container">
     <div class="post">
    <div class="post__back">
    	<a href="/">&lt;-- home</a>
    </div>
    <div class="post__title">
    	<h1>Articles / Le hack 2023</h1>
	<i>June 30, 2023</i>
    </div>
    <div class="post__meta">
    	<p></p>
    </div>
    <div class="post__content"?>
        <h1 id="advens-Ã -lÃ©vÃ¨nement-lehack-2023">Advens Ã  lâ€™Ã©vÃ¨nement LeHack 2023</h1>

<p>Cette annÃ©e encore, notre Redteam Ã©tait au rendez-vous pour assister Ã  lâ€™Ã©vÃ¨nement LeHack.</p>

<p>Existant depuis 2001 (auparavant nommÃ©e â€œNuit du Hackâ€ jusquâ€™en 2019), cette convention propose de rÃ©unir les passionnÃ©s de sÃ©curitÃ© informatique autour de divers stands dâ€™entreprises du secteur mais aussi des associations et Ã©coles spÃ©cialisÃ©es.</p>

<p>Des confÃ©rences techniques ont lieu tout au long de lâ€™Ã©vÃ¨nement et laissent divers intervenants prÃ©senter les rÃ©sultats de leurs sujets de recherche dont voici quelques rÃ©sumÃ©s :</p>

<p><br /></p>

<h2 id="confÃ©rence-du-driver-windows-Ã -ledr-par-aurÃ©lien-chalot">ConfÃ©rence â€œDu Driver Windows Ã  lâ€™EDRâ€ par <a href="https://twitter.com/Defte_">AurÃ©lien CHALOT</a></h2>

<p><em>De nos jours, pour dÃ©tecter les malwares, les antivirus reposent principalement sur lâ€™analyse dynamique. Pour Ã©tudier le comportement dâ€™un malware, il est nÃ©cessaire que les solutions dâ€™antivirus aient le moyen dâ€™intercepter ses actions. Pour cela, Microsoft a ajoutÃ© au sein de lâ€™OS Windows ce que lâ€™on appelle des kernel callbacks. Ces kernels callbacks sont en fait des fonctions de lâ€™API Windows qui permettent, moyennant un niveau de privilÃ¨ge fort, dâ€™intercepter les actions dâ€™un malware. Pour avoir les privilÃ¨ges suffisants, il est nÃ©cessaire que ces fonctions soient utilisÃ©es par un certain type de composant : les drivers.</em></p>

<p>Source : <a href="https://lehack.org/fr/track/du-driver-windows-a-ledr/">https://lehack.org/fr/track/du-driver-windows-a-ledr/</a></p>

<p>Lors de cette confÃ©rence, AurÃ©lien a retracÃ© lâ€™historique des divers moyens utilisÃ©s au cours des derniÃ¨res dÃ©cennies pour protÃ©ger nos systÃ¨mes contre les logiciels malveillants. La technicitÃ© et lâ€™innovation des attaquants Ã©voluant au rythme asynchrone des Ã©volutions techniques permettant de repÃ©rer ces derniers, nous en sommes alors Ã  lâ€™Ã©poque des EDR (Endpoint detection and response).</p>

<p>Câ€™est dans un objectif dâ€™auto-apprentissage quâ€™AurÃ©lien a alors dÃ©cidÃ© dâ€™entreprendre le dÃ©veloppement dâ€™un â€œEDR maisonâ€. Cet EDR utilisant les fonctionnalitÃ©s de lâ€™API Windows (et particuliÃ¨rement les kernels callbacks, dont les spÃ©cificitÃ©s sont prÃ©sentÃ©es en confÃ©rence), il faudra alors dÃ©velopper un driver.</p>

<p>Au travers dâ€™exemples de code, la confÃ©rence met alors lâ€™accent sur la complexitÃ© liÃ©e Ã  ce type de dÃ©veloppement bas niveau, ainsi que les contraintes que les EDR doivent alors surmonter avant mÃªme de dÃ©montrer leur efficacitÃ©.</p>

<p><br /></p>

<h2 id="confÃ©rence-parasitage-de-serveur-for-fun-and-profit-de-damien-virtualabs-cauquil">ConfÃ©rence <strong>Parasitage de serveur for fun and profit</strong> de <a href="https://twitter.com/virtualabs">Damien <em>Virtualabs</em> CAUQUIL</a>.</h2>

<p><em>Les serveurs et applications web reposent sur des technologies qui peuvent dans certains cas Ãªtre dÃ©tournÃ©es et utilisÃ©es Ã  des fins non-prÃ©vues. Il est ainsi possible de parasiter un serveur ou une application en y stockant des donnÃ©es sans que ces derniers ne sâ€™en rendent compte tout en permettant leur rÃ©cupÃ©ration dans un dÃ©lai plus ou moins court, et ce sans nÃ©cessitÃ© dâ€™authentification ou que cela soit facilement dÃ©tectable !</em></p>

<p>Source : <a href="https://lehack.org/track/parasitage-de-serveur-for-fun-and-profit/">https://lehack.org/track/parasitage-de-serveur-for-fun-and-profit/</a></p>

<p>Nous allons vous prÃ©senter cette mÃ©thode simple et ingÃ©nieuse de dÃ©tournement dâ€™application pour stocker des fichiers sans mÃªme Ãªtre authentifiÃ©.</p>

<p>Prenons comme exemple une application disposant dâ€™une mire dâ€™authentification :</p>

<p><img src="/assets/img/articles/lehack23/Parasite1.png" alt="authent" title="Notre application avec une mire d'authentification" /></p>

<p>Nous constatons que le formulaire pour ajouter son adresse mail ne contrÃ´le pas le format du texte renseignÃ©, ni sa longueur.</p>

<p><strong>Session 1 :</strong></p>

<p><img src="/assets/img/articles/lehack23/Parasite2.png" alt="email" title="Formulaire email" /></p>

<p>De plus, un cookie stocke la valeur Ã©crite dans le formulaire.
Câ€™est un cookie dont le paramÃ¨tre <em>durÃ©e maximum</em> est fixÃ© Ã  <em>Session</em>. Cela signifie que si lâ€™on recharge la page dâ€™authentification le cookie reste le mÃªme et la valeur dâ€™email rÃ©apparaÃ®t dans le formulaire. Si nous fermons la page ou le navigateur, le cookie est supprimÃ© cÃ´tÃ© client et le formulaire <em>Email address</em> nâ€™est plus auto-rempli.</p>

<p><strong>Session 2 :</strong></p>

<p><img src="/assets/img/articles/lehack23/Parasite3.png" alt="new" title="Nouveau cookie" /></p>

<p>Cependant, cela ne signifie pas quâ€™il ait Ã©galement bien Ã©tÃ© supprimÃ© cÃ´tÃ© serveur. Des cookies de sessions et les informations qui y sont liÃ©es peuvent Ãªtre stockÃ©s des heures, des jours ou des mois aprÃ¨s la fin de la session, en fonction de la configuration du serveur.</p>

<p>Par exemple, si nous regardons sur le serveur hÃ©bergeant lâ€™application, nous constatons que les cookies des deux sessions sont prÃ©sents, mÃªme si la premiÃ¨re est terminÃ©e.</p>

<p><img src="/assets/img/articles/lehack23/Parasite4.png" alt="ls" title="ls cookie" /></p>

<p>Nous pouvons y retrouver la valeur que nous avions entrÃ©e dans le formulaire <em>Email address</em>.</p>

<p><img src="/assets/img/articles/lehack23/Parasite5.png" alt="cat" title="cat cookie" /></p>

<p>Nous souhaitons alors stocker le contenu dâ€™un fichier Ã  la place du message <em>Bonjour</em>.</p>

<p>Nous encodons une image PNG en base 64. Cela fonctionne avec tout autre type de fichier.</p>

<p><img src="/assets/img/articles/lehack23/Parasite6.png" alt="png" title="Png en base 64" /></p>

<p>Nous renseignons notre image encodÃ©e en base 64 dans le formulaire <em>Email address</em> et nous sauvegardons la valeur du cookie de notre session.</p>

<p><img src="/assets/img/articles/lehack23/Parasite7.png" alt="depot" title="Depot de l'image" /></p>

<p>Lâ€™image est bien Ã©crite sur le serveur :</p>

<p><img src="/assets/img/articles/lehack23/Parasite8.png" alt="image" title="Image sur le serveur" /></p>

<p>Quelques jours plus tard, nous pouvons rÃ©cupÃ©rer notre document en remplissant la valeur du cookie de la session dans notre navigateur.</p>

<p><img src="/assets/img/articles/lehack23/Parasite9.png" alt="recuperation" title="Image rÃ©cupÃ©ration" /></p>

<p>Pour Ã©viter le parasitage de votre serveur, nous vous invitons Ã  :</p>
<ul>
  <li>ContrÃ´ler le format et la longueur de tout texte renseignÃ© par un utilisateur;</li>
  <li>Initialiser un cookie de session aprÃ¨s lâ€™authentification rÃ©ussie de lâ€™utilisateur;</li>
  <li>Supprimer cÃ´tÃ© serveur le cookie lors de la dÃ©connexion de lâ€™utilisateur;</li>
  <li>Utiliser un antivirus sur votre serveur pour supprimer les fichiers malveillants.</li>
</ul>

<p><br /></p>

<h2 id="confÃ©rence-prototype-pollution-and-where-to-find-them-par-bitk-et-sakiir">ConfÃ©rence â€œPrototype pollution and where to find themâ€ par <a href="https://twitter.com/bitk_">Bitk</a> et <a href="https://twitter.com/sakiirsecurity">Sakiir</a></h2>

<p><em>La pollution des prototypes est une vulnÃ©rabilitÃ© dans les applications JavaScript qui peut avoir des impacts variables en fonction de la complexitÃ© et de la nature de lâ€™application affectÃ©e. Elle exploite la fonction dâ€™hÃ©ritage de prototype JavaScript, qui permet aux objets dâ€™hÃ©riter de propriÃ©tÃ©s et de mÃ©thodes. En manipulant la chaÃ®ne de prototypes dâ€™un objet, un attaquant peut introduire des propriÃ©tÃ©s malveillantes, conduisant Ã  un comportement inattendu et permettant potentiellement Ã  lâ€™attaquant dâ€™exÃ©cuter du code arbitraire.</em></p>

<p>Source : <a href="https://lehack.org/fr/track/prototype-pollution-and-where-to-find-them/">https://lehack.org/fr/track/prototype-pollution-and-where-to-find-them/</a></p>

<p>La confÃ©rence avait pour but de prÃ©senter un aperÃ§u des prototypes JavaScript et des attaques par pollution de ceux-ci.</p>

<p>Un outil destinÃ© Ã  dÃ©tecter ce type dâ€™attaque en audit de code ou bien en test dâ€™intrusion en boÃ®te blanche nous a Ã©tÃ© prÃ©sentÃ© afin dâ€™identifier plus facilement ce type de vulnÃ©rabilitÃ© sur de grosses applications basÃ©es sur le langage Javascript. Celui ci est accessible sur le gitlab suivant : <a href="https://github.com/yeswehack/pp-finder">https://github.com/yeswehack/pp-finder</a></p>

<p>Enfin, plusieurs exemples de dÃ©tection et dâ€™exploitation de prototype pollution dans un context de test dâ€™intrusion en boÃ®te noire nous ont Ã©tÃ© prÃ©sentÃ©s. Des exemples de charges utiles permettant dâ€™exploiter les attaques de prototype pollution sur des frameworks ou librairies JavaScripts connus tels que VueJS ^3.2.47, Fastify ^4.13.0 ou Axios 0.27.2 ont pu nous Ãªtre prÃ©sentÃ©es.</p>

<p>Les consÃ©quences de lâ€™exploitation dâ€™une telle vulnÃ©rabilitÃ© sont variable en fonction de lâ€™application et des librairies utilisÃ©es pouvant permettre de rÃ©aliser par la suite une attaque SSRF (Server Side Request Forgery), jusquâ€™Ã  lâ€™execution de code Ã  distance sur le serveur.</p>

<p>Pour conclure, les vulnÃ©rabilitÃ©s de prototype pollution sont souvent difficiles Ã  dÃ©tecter dans une approche de test dâ€™intrusion en boÃ®te noire, et lâ€™exploitation dÃ©pend alors majoritairement des composants utilisÃ©s par lâ€™application ciblÃ©e. Il est aussi important de prÃ©ciser que lâ€™exploitation de cette vulnÃ©rabilitÃ© peut avoir des effets de bord important sur lâ€™application pouvant dans certains cas crÃ©er un dÃ©ni de service en corrompant les propriÃ©tÃ©s de lâ€™application.</p>

<p>Un article publiÃ© sur YesWeHack, rÃ©sume les diffÃ©rentes maniÃ¨res de dÃ©tÃ©cter et dâ€™exploiter cette vulnÃ©rabilitÃ© : <a href="https://blog.yeswehack.com/talent-development/server-side-prototype-pollution-how-to-detect-and-exploit/">https://blog.yeswehack.com/talent-development/server-side-prototype-pollution-how-to-detect-and-exploit/</a></p>

<p><br /></p>

<h2 id="confÃ©rence-dpapi---dont-put-administration-passwords-in-par-thomas-seigneuret-et-pierre-alexandre-vandewoestyne">ConfÃ©rence â€œDPAPI - Donâ€™t Put Administration Passwords Inâ€ par <a href="https://twitter.com/_zblurx">Thomas SEIGNEURET</a> et <a href="https://twitter.com/T00uF">Pierre-Alexandre VANDEWOESTYNE</a></h2>

<p><em>La DPAPI est une API des OS Windows mise Ã  disposition des dÃ©veloppeurs pour stocker facilement les secrets des utilisateurs, sans quâ€™ils aient Ã  se soucier de la partie crypto. Pour les dÃ©veloppeurs, il suffit dâ€™utiliser les fonctions Protect et Unprotect pour respectivement stocker de maniÃ¨re sÃ©curisÃ©e les donnÃ©es et accÃ©der aux donnÃ©es stockÃ©es. Beaucoup de secrets diffÃ©rents sont stockÃ©s via la DPAPI : â€“ Mots de passe de Tasks Scheduled â€“ Mots de passe dans les navigateurs (Chrome Based et Internet Explorer) â€“ ClÃ© privÃ©e des certificats â€“ Mots de passe de certaines solutions (notamment des solutions dâ€™administrations Ã  distance) â€“ etc. Dâ€™un point de vue offensif, ces secrets sont trÃ¨s intÃ©ressants Ã  rÃ©cupÃ©rer, prÃ© et post compromission de domaine, et permettent souvent de pousser plus loin la compromission dâ€™un SI.</em></p>

<p>Source : <a href="https://lehack.org/fr/track/dpapi-dont-put-administration-passwords-in/">https://lehack.org/fr/track/dpapi-dont-put-administration-passwords-in/</a></p>

<p>Une confÃ©rence attendue Ã©tait celle de Thomas Seigneuret et Pierre-Alexandre Vandewoestyne sur la DPAPI. Cette API, propre aux systÃ¨mes Windows, permet de faciliter la sauvegarde de secrets.</p>

<p>Les deux experts expliquent quâ€™elle peut facilement devenir un outil redoutable pour un attaquant. Il suffit de compromettre un poste ou serveur Windows dâ€™une entreprise pour rÃ©cupÃ©rer de nombreux identifiants tels que des mots de passe de navigateurs, de tÃ¢ches planifiÃ©es, de bureau Ã  distance, ou encore des clÃ©s privÃ©es de certificats et de points dâ€™accÃ¨s Wi-Fi.</p>

<p>Pire, pour quelquâ€™un ayant compromis un contrÃ´leur de domaine Active Directory, il devient possible de rapidement rÃ©cupÃ©rer tous ces identifiants de tous les utilisateurs du domaine. Cela peut rapidement permettre de rebondir sur dâ€™autres pÃ©rimÃ¨tres ou services externes Ã  lâ€™entreprise compromise (Tenant Azure, NAS, backups, â€¦).</p>

<p><br /></p>

<h2 id="confÃ©rence-physical-intrusion-for-fun-and-profit-par-anthony-boens">ConfÃ©rence â€œPhysical Intrusion For Fun And Profitâ€ par Anthony BOENS</h2>

<p><em>Lors de missions de type intrusion physique, les auditeurs se retrouvent face Ã  diffÃ©rents blocages physiques. Le but de cette prÃ©sentation a pour objectif de dÃ©montrer que nombreux de ces dispositifs de blocage peuvent Ãªtre contournÃ©s facilement et sans entraÃ®nement. En effet, qui ne sest jamais retrouvÃ© face Ã  un Digicode en mÃ©tal ? Une porte fermÃ©e avec un cylindre de mauvaise qualitÃ© ? Ou encore, un portail tÃ©lÃ©commandÃ© ?</em></p>

<p>Source : <a href="https://lehack.org/fr/track/physical-intrusion-for-fun-and-profit/">https://lehack.org/fr/track/physical-intrusion-for-fun-and-profit/</a></p>

<p>La premiÃ¨re journÃ©e de confÃ©rences sâ€™est clÃ´turÃ©e par une prÃ©sentation sur les tests dâ€™intrusion physique et plus particuliÃ¨rement sur des techniques de crochetage, dites de â€œlockpickingâ€.</p>

<p>Anthony a dÃ©montrÃ© que la plupart des serrures sur le marchÃ© peuvent Ãªtre cassÃ©es en trÃ¨s peu de temps. Certaines demandent du matÃ©riel spÃ©cifique, pour par exemple tester plusieurs dizaines de combinaisons dâ€™un coup et trouver le bon alignement des goupilles en quelques secondes. Mais pour un prix bon marchÃ©, la plupart des portes que nous ouvrons au quotidien peuvent facilement Ãªtre ouvertes Ã  lâ€™insu de leur propriÃ©taire.</p>

<p>Vous avez peur de laisser des traces en crochetant ? Certaines portes claquÃ©es peuvent Ãªtre ouvertes sans crochetage, simplement Ã  lâ€™aide dâ€™une fine feuille rigide, comme des rÃ©sultats mÃ©dicaux de scanner, ou avec votre carte de crÃ©dit, comme lâ€™explique Anthony. Cette technique consiste Ã  glisser la carte entre la porte et le bÃ¢ti et Ã  remonter jusquâ€™Ã  la serrure en donnant de lÃ©gers coups dans la porte pour insÃ©rer notre carte et libÃ©rer le pÃªne demi-tour pour ouvrir la porte.</p>

<p>Enfin, les portails et voitures Ã  ouverture Ã  distance nâ€™Ã©chappent pas aux attaques par interception de signal radio. En se positionnant entre lâ€™usager et lâ€™Ã©quipement, un attaquant peut intercepter le signal envoyÃ© par le â€œbipâ€ (tÃ©lÃ©commande). Un simple relai du signal permet dâ€™ouvrir des portes de voitures ou de portails privÃ©s.</p>

<p>Cette confÃ©rence prouve que les sÃ©curitÃ©s physiques ne sont pas encore au niveau de sÃ©curitÃ© attendu par les professionnels et elle dÃ©montre le besoin de sensibiliser les collaborateurs des entreprises Ã  la prÃ©sence dâ€™intrus dans leurs locaux.</p>


    </div>
</div>


    </div>
  </body>
</html>
